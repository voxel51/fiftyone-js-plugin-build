"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const a=require("@rollup/plugin-node-resolve"),l=require("@vitejs/plugin-react"),_=require("node:fs"),f=require("node:path"),c=require("vite"),u=require("vite-plugin-externalize-deps"),s=["@fiftyone/components","@fiftyone/operators","@fiftyone/state","@fiftyone/utilities","@fiftyone/spaces","@fiftyone/plugins","@fiftyone/aggregations","@fiftyone/core","@fiftyone/embeddings","@fiftyone/looker","@fiftyone/map","@fiftyone/playback","@fiftyone/spotlight","@fiftyone/flashlight","@fiftyone/looker-3d"],r=[...s,"styled-components","recoil","react","react-dom","@mui/material"];async function d(i){const e=f.join(i,"package.json"),n=await _.promises.readFile(e,"utf-8");return JSON.parse(n)}const y=(i,e=!1)=>{const n=Object.keys(i.dependencies),t=n.filter(o=>!r.includes(o)&&!o.startsWith("@fiftyone"));return e&&n.includes("@mui/material")&&t.push("@mui/material"),t};function m(){const{FIFTYONE_DIR:i}=process.env;if(!i)throw new Error("FIFTYONE_DIR environment variable not set. This is required to resolve @fiftyone/* imports.");return{name:"fiftyone-bundle-private-packages",enforce:"pre",resolveId:e=>{if(e.startsWith("@fiftyone")&&!s.includes(e)){const n=e.split("/")[1],t=`${i}/app/packages/${n}`;return this.resolve(t,e,{skipSelf:!0})}return null}}}async function g(i,e={}){const n=await d(i),t=y(n,e==null?void 0:e.forceBundleMui);return console.log("Bundling the following third party dependencies:",t.join(", ")),c.defineConfig({mode:"development",plugins:[m(),a(),l({jsxRuntime:"classic"}),u.externalizeDeps({deps:!1,devDeps:!1,useFile:f.join(process.cwd(),"package.json"),include:e!=null&&e.forceBundleMui?r.filter(o=>o!=="@mui/material"):r}),...(e==null?void 0:e.plugins)??[]],build:{minify:!0,lib:{entry:f.join(i,n.main),name:n.name,fileName:o=>`index.${o}.js`,formats:["umd"]},rollupOptions:{output:{globals:{react:"React",recoil:"recoil","react-dom":"ReactDOM","jsx-runtime":"jsx","react/jsx-runtime":"jsx","@fiftyone/state":"__fos__","@fiftyone/plugins":"__fop__","@fiftyone/operators":"__foo__","@fiftyone/components":"__foc__","@fiftyone/utilities":"__fou__","@fiftyone/spaces":"__fosp__","@fiftyone/aggregations":"__foa__","@fiftyone/core":"__focore__","@fiftyone/embeddings":"__foe__","@fiftyone/looker":"__fol__","@fiftyone/map":"__fom__","@fiftyone/playback":"__fopb__","@fiftyone/spotlight":"__fosl__","@fiftyone/flashlight":"__fof__","@fiftyone/looker-3d":"__fol3d__","@mui/material":"__mui__","styled-components":"__styled__"}}},...(e==null?void 0:e.buildConfigOverride)??{}},define:{"process.env.NODE_ENV":'"development"'},optimizeDeps:{exclude:["react","react-dom"]},...(e==null?void 0:e.vite)??{}})}exports.defineConfig=g;
